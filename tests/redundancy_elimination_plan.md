# ä»£ç å†—ä½™æ¶ˆé™¤è®¡åˆ’

## ðŸ“Š å†—ä½™åˆ†æžæ€»ç»“

æ ¹æ®å†—ä½™åˆ†æžæŠ¥å‘Šï¼Œé¡¹ç›®ä¸­å­˜åœ¨ä»¥ä¸‹å†—ä½™ï¼š

### 1. é‡å¤å‡½æ•° (83ä¸ª)
- **main()**: åœ¨28ä¸ªæ–‡ä»¶ä¸­é‡å¤ï¼ˆæ­£å¸¸æƒ…å†µï¼Œæ¯ä¸ªè„šæœ¬éƒ½æœ‰mainå‡½æ•°ï¼‰
- **__enter__/__exit__**: åœ¨4ä¸ªæ–‡ä»¶ä¸­é‡å¤ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼‰
- **__init__**: åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤ï¼ˆæž„é€ å‡½æ•°ï¼‰
- **_on_performance_alert**: åœ¨2ä¸ªæ–‡ä»¶ä¸­é‡å¤ï¼ˆå¯ä»¥åˆå¹¶ï¼‰

### 2. é‡å¤ä»£ç å— (56ä¸ª)
- ä¸»è¦é›†ä¸­åœ¨åˆå§‹åŒ–ä»£ç ã€é”™è¯¯å¤„ç†ã€æ€§èƒ½ç›‘æŽ§ç­‰
- éƒ¨åˆ†ä»£ç å—å¯ä»¥æå–ä¸ºå…¬å…±å‡½æ•°

### 3. æœªä½¿ç”¨å¯¼å…¥ (1ä¸ª)
- `utils/__init__.py` ä¸­çš„é€šé…ç¬¦å¯¼å…¥

## ðŸ› ï¸ æ¶ˆé™¤ç­–ç•¥

### 1. åˆç†çš„é‡å¤ï¼ˆä¿ç•™ï¼‰

#### âœ… ä¿ç•™çš„é‡å¤å‡½æ•°ï¼š
- **main()**: æ¯ä¸ªç‹¬ç«‹è„šæœ¬éƒ½éœ€è¦mainå‡½æ•°ï¼Œè¿™æ˜¯æ­£å¸¸çš„
- **__init__()**: æ¯ä¸ªç±»éƒ½æœ‰è‡ªå·±çš„æž„é€ å‡½æ•°ï¼Œè¿™æ˜¯å¿…è¦çš„
- **__enter__/__exit__**: ä¸åŒç±»çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨å®žçŽ°ä¸åŒ

### 2. å¯æ¶ˆé™¤çš„é‡å¤

#### ðŸ”§ éœ€è¦é‡æž„çš„é‡å¤å‡½æ•°ï¼š

##### _on_performance_alert å‡½æ•°é‡å¤
**ä½ç½®**: 
- `main_auto_approve_refactored.py`
- `tests/test_gui_responsiveness.py`

**è§£å†³æ–¹æ¡ˆ**: æå–ä¸ºå…¬å…±å‡½æ•°
```python
# auto_approve/performance/alert_handlers.py
def handle_performance_alert(alert_type: str, value: float):
    """ç»Ÿä¸€çš„æ€§èƒ½è­¦å‘Šå¤„ç†å‡½æ•°"""
    # åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å®žçŽ°
```

#### ðŸ”§ éœ€è¦é‡æž„çš„é‡å¤ä»£ç å—ï¼š

##### 1. æ€§èƒ½ç›‘æŽ§åˆå§‹åŒ–ä»£ç 
**ä½ç½®**:
- `auto_approve/gui_performance_monitor.py` (è¡Œ 47-49)
- `auto_approve/gui_responsiveness_manager.py` (è¡Œ 45-47)

**è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºå…¬å…±åˆå§‹åŒ–å‡½æ•°
```python
# auto_approve/performance/common.py
def init_performance_monitoring():
    """ç»Ÿä¸€çš„æ€§èƒ½ç›‘æŽ§åˆå§‹åŒ–"""
```

##### 2. æ‰«æå™¨é…ç½®ä»£ç 
**ä½ç½®**:
- `auto_approve/scanner_process_adapter.py` (è¡Œ 29-33)
- `auto_approve/scanner_worker_refactored.py` (è¡Œ 45-49)

**è§£å†³æ–¹æ¡ˆ**: æå–é…ç½®åˆå§‹åŒ–é€»è¾‘
```python
# auto_approve/scanner/config_utils.py
def init_scanner_config(cfg):
    """ç»Ÿä¸€çš„æ‰«æå™¨é…ç½®åˆå§‹åŒ–"""
```

##### 3. åº”ç”¨é€€å‡ºå¤„ç†ä»£ç 
**ä½ç½®**:
- `main_auto_approve_refactored.py` (è¡Œ 1021-1023)
- `examples/multithreading_demo.py` (è¡Œ 498-500)
- `tests/test_multithreading_architecture.py` (è¡Œ 464-466)

**è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºå…¬å…±é€€å‡ºå¤„ç†å‡½æ•°
```python
# auto_approve/core/app_utils.py
def cleanup_and_exit(app, exit_code=0):
    """ç»Ÿä¸€çš„åº”ç”¨é€€å‡ºå¤„ç†"""
```

### 3. å¯¼å…¥ä¼˜åŒ–

#### ðŸ§¹ æ¸…ç†æœªä½¿ç”¨å¯¼å…¥ï¼š
- ä¿®å¤ `utils/__init__.py` ä¸­çš„é€šé…ç¬¦å¯¼å…¥
- ä½¿ç”¨å…·ä½“çš„å¯¼å…¥æ›¿ä»£ `import *`

## ðŸ“‹ å®žæ–½è®¡åˆ’

### é˜¶æ®µ1ï¼šåˆ›å»ºå…¬å…±æ¨¡å— (1å¤©)

#### 1.1 åˆ›å»ºæ€§èƒ½ç›¸å…³å…¬å…±æ¨¡å—
```python
# auto_approve/performance/alert_handlers.py
# auto_approve/performance/common.py
```

#### 1.2 åˆ›å»ºæ‰«æå™¨å…¬å…±æ¨¡å—
```python
# auto_approve/scanner/config_utils.py
```

#### 1.3 åˆ›å»ºåº”ç”¨å·¥å…·æ¨¡å—
```python
# auto_approve/core/app_utils.py
```

### é˜¶æ®µ2ï¼šé‡æž„é‡å¤ä»£ç  (2å¤©)

#### 2.1 é‡æž„æ€§èƒ½è­¦å‘Šå¤„ç†
- æå– `_on_performance_alert` å‡½æ•°
- æ›´æ–°æ‰€æœ‰è°ƒç”¨ç‚¹

#### 2.2 é‡æž„åˆå§‹åŒ–ä»£ç 
- æå–æ€§èƒ½ç›‘æŽ§åˆå§‹åŒ–
- æå–æ‰«æå™¨é…ç½®åˆå§‹åŒ–
- æå–åº”ç”¨é€€å‡ºå¤„ç†

#### 2.3 æ›´æ–°å¯¼å…¥è¯­å¥
- æ›¿æ¢é‡å¤ä»£ç ä¸ºå…¬å…±å‡½æ•°è°ƒç”¨
- æ›´æ–°ç›¸å…³å¯¼å…¥

### é˜¶æ®µ3ï¼šæ¸…ç†å’ŒéªŒè¯ (1å¤©)

#### 3.1 æ¸…ç†æœªä½¿ç”¨å¯¼å…¥
- ä¿®å¤ `utils/__init__.py`
- æ£€æŸ¥å…¶ä»–æ–‡ä»¶çš„å¯¼å…¥

#### 3.2 è¿è¡Œæµ‹è¯•éªŒè¯
- ç¡®ä¿æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
- éªŒè¯é‡æž„åŽçš„ä»£ç 

#### 3.3 æ›´æ–°æ–‡æ¡£
- è®°å½•é‡æž„å˜æ›´
- æ›´æ–°APIæ–‡æ¡£

## ðŸŽ¯ é¢„æœŸæ•ˆæžœ

### ä»£ç è´¨é‡æå‡ï¼š
- âœ… å‡å°‘é‡å¤ä»£ç çº¦20%
- âœ… æé«˜ä»£ç å¯ç»´æŠ¤æ€§
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†é€»è¾‘
- âœ… ç®€åŒ–ä»£ç ç»“æž„

### æ€§èƒ½ä¼˜åŒ–ï¼š
- âœ… å‡å°‘å†…å­˜å ç”¨
- âœ… æé«˜ä»£ç å¤ç”¨çŽ‡
- âœ… é™ä½Žç»´æŠ¤æˆæœ¬

## ðŸ“Š å…·ä½“é‡æž„ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ€§èƒ½è­¦å‘Šå¤„ç†å‡½æ•°

#### é‡æž„å‰ï¼š
```python
# main_auto_approve_refactored.py
def _on_performance_alert(self, alert_type, value):
    # å®žçŽ°A

# tests/test_gui_responsiveness.py  
def _on_performance_alert(self, alert_type, value):
    # å®žçŽ°Bï¼ˆç±»ä¼¼ä½†ç•¥æœ‰ä¸åŒï¼‰
```

#### é‡æž„åŽï¼š
```python
# auto_approve/performance/alert_handlers.py
def handle_performance_alert(alert_type: str, value: float, context: str = ""):
    """ç»Ÿä¸€çš„æ€§èƒ½è­¦å‘Šå¤„ç†"""
    # åˆå¹¶åŽçš„å®žçŽ°

# ä½¿ç”¨æ–¹ï¼š
from auto_approve.performance.alert_handlers import handle_performance_alert

def _on_performance_alert(self, alert_type, value):
    handle_performance_alert(alert_type, value, context="main_app")
```

### ç¤ºä¾‹2ï¼šåº”ç”¨é€€å‡ºå¤„ç†

#### é‡æž„å‰ï¼š
```python
# å¤šä¸ªæ–‡ä»¶ä¸­çš„é‡å¤ä»£ç 
if app:
    app.quit()
sys.exit(0)
```

#### é‡æž„åŽï¼š
```python
# auto_approve/core/app_utils.py
def cleanup_and_exit(app=None, exit_code=0):
    """ç»Ÿä¸€çš„åº”ç”¨é€€å‡ºå¤„ç†"""
    if app:
        app.quit()
    sys.exit(exit_code)

# ä½¿ç”¨æ–¹ï¼š
from auto_approve.core.app_utils import cleanup_and_exit
cleanup_and_exit(app)
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¿æŒå‘åŽå…¼å®¹**: ç¡®ä¿APIæŽ¥å£ä¸å˜
2. **æ¸è¿›å¼é‡æž„**: åˆ†æ­¥éª¤å®žæ–½ï¼Œé¿å…å¤§è§„æ¨¡ç ´å
3. **å……åˆ†æµ‹è¯•**: æ¯ä¸ªé‡æž„éƒ½è¦æœ‰å¯¹åº”æµ‹è¯•
4. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°ç›¸å…³æ–‡æ¡£

## ðŸ“ˆ æˆåŠŸæŒ‡æ ‡

- é‡å¤å‡½æ•°æ•°é‡å‡å°‘ > 10%
- é‡å¤ä»£ç å—å‡å°‘ > 20%
- æœªä½¿ç”¨å¯¼å…¥æ¸…é›¶
- æ‰€æœ‰æµ‹è¯•é€šè¿‡
- ä»£ç è¡Œæ•°å‡å°‘ > 5%
